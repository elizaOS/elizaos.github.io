{
  "interval": {
    "intervalStart": "2026-02-04T00:00:00.000Z",
    "intervalEnd": "2026-02-05T00:00:00.000Z",
    "intervalType": "day"
  },
  "repository": "elizaos-plugins/plugin-mcp",
  "overview": "From 2026-02-04 to 2026-02-05, elizaos-plugins/plugin-mcp had 1 new PRs (1 merged), 0 new issues, and 3 active contributors.",
  "topIssues": [],
  "topPRs": [
    {
      "id": "PR_kwDOOqp3ps7BfMi2",
      "title": "feat: per-user MCP connections with dynamic API key injection",
      "author": "0xbbjoker",
      "number": 23,
      "body": "<!-- CURSOR_SUMMARY -->\n> [!NOTE]\n> **Medium Risk**\n> Changes MCP connection lifecycle and request headers, which can affect multi-tenant isolation and connectivity behavior if request context or URL-origin checks are misconfigured. Also shifts `@elizaos/core` to a peer dependency, which may impact consumersâ€™ dependency resolution.\n> \n> **Overview**\n> Adds **per-user MCP HTTP connections** by keying connections with `serverName:entityId` (via `getRequestContext()`), while keeping `stdio` transports shared; `ensureConnected`, `callTool`, `readResource`, and `restartConnection` now resolve the appropriate user-specific connection.\n> \n> For HTTP transports, automatically injects an `X-API-Key` header from runtime setting `ELIZAOS_API_KEY` when not already provided, but only for same-origin requests to avoid leaking credentials.\n> \n> Bumps package version to `1.8.2` and updates packaging so `@elizaos/core` is a `peerDependency` (and dev dependency) rather than a runtime dependency.\n> \n> <sup>Written by [Cursor Bugbot](https://cursor.com/dashboard?tab=bugbot) for commit b57beee934f1e2d75cfa407ccb2af4e0aa90b657. This will update automatically on new commits. Configure [here](https://cursor.com/dashboard?tab=bugbot).</sup>\n<!-- /CURSOR_SUMMARY -->\n\n<!-- This is an auto-generated comment: release notes by coderabbit.ai -->\n\n## Summary by CodeRabbit\n\n* **New Features**\n  * Automatic API key injection for secure HTTP requests\n  * Per-user connection isolation for improved multi-user support\n\n* **Chores**\n  * Version bumped to 1.8.2\n  * Dependency management restructured\n\n<!-- end of auto-generated comment: release notes by coderabbit.ai -->\n\n<!-- greptile_comment -->\n\n<h2>Greptile Overview</h2>\n\n<h3>Greptile Summary</h3>\n\nThis PR enables per-user MCP server connections in multi-tenant environments by leveraging request context to create isolated connections per entity. It moves `@elizaos/core` to peerDependencies to ensure request context is shared, and implements dynamic API key injection from context into HTTP headers.\n\n**Key Changes:**\n- Per-user connection isolation: Connection keys now include entityId for HTTP/SSE transports (e.g., `serverName:entityId`)\n- Dynamic API key injection: Reads `ELIZAOS_API_KEY` from request context and injects into `X-API-Key` header for same-origin requests\n- Peer dependency change: Moved `@elizaos/core` to peerDependencies to share singleton request context\n\n**Critical Issues Found:**\n- Connection key logic fails for eagerly-connected servers: `getConnectionKey()` only checks `lazyConnections` to determine transport type, so eagerly-connected HTTP servers won't get per-user isolation\n- `restartConnection` bug: Uses `getConnectionKey()` to get user-specific key but connection may exist under base key, causing disconnect/reconnect to target wrong connection\n- Environment variable fallback risk: Origin check defaults to `http://localhost:3000` if env vars aren't set, which could cause issues in production\n\n<h3>Confidence Score: 2/5</h3>\n\n- This PR has critical logic bugs that will break connection management in production multi-tenant deployments\n- The per-user isolation feature is well-intentioned but has multiple implementation bugs: getConnectionKey() fails for eagerly-connected HTTP servers, restartConnection() targets wrong connection keys, and environment variable handling is fragile. These issues will cause connection leaks and incorrect routing in production.\n- src/service.ts requires immediate attention to fix connection key management logic\n\n<h3>Important Files Changed</h3>\n\n\n\n\n| Filename | Overview |\n|----------|----------|\n| package.json | Version bump to 1.8.2 and moved `@elizaos/core` to peerDependencies to share request context |\n| src/service.ts | Implements per-user MCP connections with dynamic API key injection; contains critical bugs in connection key management |\n\n</details>\n\n\n\n<h3>Sequence Diagram</h3>\n\n```mermaid\nsequenceDiagram\n    participant UserA\n    participant UserB\n    participant McpService\n    participant Context\n    participant Server\n    \n    Note over McpService: Initialization\n    McpService->>McpService: init() creates base connections\n    McpService->>Server: connect(baseName)\n    \n    Note over UserA,Server: First User Request\n    UserA->>Context: Set entity context\n    UserA->>McpService: callTool(serverName)\n    McpService->>McpService: ensureConnected(serverName)\n    McpService->>Context: getRequestContext()\n    Context-->>McpService: entity context returned\n    McpService->>McpService: getConnectionKey(serverName)<br/>returns user-specific key\n    McpService->>McpService: Check connection map\n    Note over McpService: No user-specific connection<br/>exists, create new one\n    McpService->>McpService: Inject headers from context\n    McpService->>Server: New connection with headers\n    McpService->>Server: Execute tool\n    \n    Note over UserB,Server: Second User Request\n    UserB->>Context: Set different entity context\n    UserB->>McpService: callTool(serverName)\n    McpService->>McpService: ensureConnected(serverName)\n    McpService->>Context: getRequestContext()\n    Context-->>McpService: different entity returned\n    McpService->>McpService: getConnectionKey(serverName)<br/>returns different key\n    McpService->>McpService: Check connection map\n    Note over McpService: Separate connection created<br/>per entity\n    McpService->>Server: New connection with<br/>different headers\n    McpService->>Server: Execute tool\n```\n\n<!-- greptile_other_comments_section -->\n\n<!-- /greptile_comment -->",
      "repository": "elizaos-plugins/plugin-mcp",
      "createdAt": "2026-02-04T14:53:32Z",
      "mergedAt": "2026-02-04T14:56:32Z",
      "additions": 54,
      "deletions": 15
    }
  ],
  "codeChanges": {
    "additions": 54,
    "deletions": 15,
    "files": 2,
    "commitCount": 2
  },
  "completedItems": [
    {
      "title": "feat: per-user MCP connections with dynamic API key injection",
      "prNumber": 23,
      "type": "feature",
      "body": "<!-- CURSOR_SUMMARY -->\n> [!NOTE]\n> **Medium Risk**\n> Changes MCP connection lifecycle and request headers, which can affect multi-tenant isolation and connectivity behavior if request context or URL-origin checks are misconfigured. Also sh",
      "files": [
        "package.json",
        "src/service.ts"
      ]
    }
  ],
  "topContributors": [
    {
      "username": "0xbbjoker",
      "avatarUrl": "https://avatars.githubusercontent.com/u/54844437?u=90fe1762420de6ad493a1c1582f1f70c0d87d8e2&v=4",
      "totalScore": 34.24849524204936,
      "prScore": 34.24849524204936,
      "issueScore": 0,
      "reviewScore": 0,
      "commentScore": 0,
      "summary": null
    },
    {
      "username": "bytes0xcr6",
      "avatarUrl": "https://avatars.githubusercontent.com/u/102038261?u=45bcd82b0f6cc2f6c6f8db5bdc01949b3afe7560&v=4",
      "totalScore": 23.546573590279973,
      "prScore": 14.346573590279972,
      "issueScore": 0,
      "reviewScore": 9,
      "commentScore": 0.2,
      "summary": null
    },
    {
      "username": "greptile-apps",
      "avatarUrl": "https://avatars.githubusercontent.com/in/867647?v=4",
      "totalScore": 9,
      "prScore": 0,
      "issueScore": 0,
      "reviewScore": 9,
      "commentScore": 0,
      "summary": null
    },
    {
      "username": "borisudovicic",
      "avatarUrl": "https://avatars.githubusercontent.com/u/31806472?u=8935f4d43fd7e4eb9bf5ff92d54d4d2f8ac8a786&v=4",
      "totalScore": 6,
      "prScore": 0,
      "issueScore": 6,
      "reviewScore": 0,
      "commentScore": 0,
      "summary": null
    }
  ],
  "newPRs": 1,
  "mergedPRs": 1,
  "newIssues": 0,
  "closedIssues": 0,
  "activeContributors": 3
}